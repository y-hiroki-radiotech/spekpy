# ãƒ•ã‚£ãƒ«ã‚¿å•é¡Œã®ä¿®æ­£ã«ã¤ã„ã¦

## å•é¡Œã®æ¦‚è¦

ä»˜åŠ ãƒ•ã‚£ãƒ«ã‚¿ï¼ˆAlã€Cuç­‰ï¼‰ã®åšã•ã‚’å¤‰æ›´ã—ãŸã‚Šã€æ–°ã—ã„ãƒ•ã‚£ãƒ«ã‚¿ã‚’è¿½åŠ ã—ãŸéš›ã«ã€ã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚„ç·šé‡è¨ˆç®—çµæœã«å¤‰åŒ–ãŒåæ˜ ã•ã‚Œãªã„å•é¡ŒãŒã‚ã‚Šã¾ã—ãŸã€‚

## å•é¡Œã®åŸå› 

1. **ESAKCalculatorã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®å†åˆ©ç”¨**: ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¹ãƒ†ãƒ¼ãƒˆã«ä¿å­˜ã•ã‚ŒãŸcalculatorã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’å†åˆ©ç”¨ã—ã¦ã„ãŸãŸã‚ã€å‰å›ã®è¨ˆç®—çµæœï¼ˆãƒ•ã‚£ãƒ«ã‚¿æƒ…å ±ã‚’å«ã‚€ï¼‰ãŒã‚¯ãƒªã‚¢ã•ã‚Œãšã«è“„ç©ã•ã‚Œã¦ã„ã¾ã—ãŸã€‚

2. **ãƒ•ã‚£ãƒ«ã‚¿çŠ¶æ…‹ã®æ®‹å­˜**: æ–°ã—ã„è¨ˆç®—ã‚’è¡Œã†å‰ã«ã€ä»¥å‰è¨­å®šã—ãŸãƒ•ã‚£ãƒ«ã‚¿æƒ…å ±ãŒæ®‹ã£ã¦ã„ã¾ã—ãŸã€‚

3. **çµæœã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥**: ãƒ•ã‚£ãƒ«ã‚¿å¤‰æ›´æ™‚ã«è¨ˆç®—çµæœãŒã‚¯ãƒªã‚¢ã•ã‚Œãšã€å¤ã„çµæœãŒè¡¨ç¤ºã•ã‚Œç¶šã‘ã¦ã„ã¾ã—ãŸã€‚

## ä¿®æ­£å†…å®¹

### 1. ESAKCalculatorã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®æ–°è¦ä½œæˆ

```python
# ä¿®æ­£å‰ï¼ˆå•é¡Œã®ã‚ã‚‹ã‚³ãƒ¼ãƒ‰ï¼‰
calculator = st.session_state.calculator  # æ—¢å­˜ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’å†åˆ©ç”¨

# ä¿®æ­£å¾Œ
calculator = ESAKCalculator()  # æ–°ã—ã„ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’æ¯å›ä½œæˆ
```

### 2. ãƒ•ã‚£ãƒ«ã‚¿å¤‰æ›´ã®æ¤œçŸ¥ã¨çµæœã‚¯ãƒªã‚¢

```python
# ãƒ•ã‚£ãƒ«ã‚¿å¤‰æ›´ã‚’æ¤œçŸ¥ã—ã¦çµæœã‚’ã‚¯ãƒªã‚¢
if st.session_state.filters != st.session_state.previous_filters:
    st.session_state.results = None
    st.session_state.previous_filters = st.session_state.filters.copy()
```

### 3. ãƒ•ã‚£ãƒ«ã‚¿è¿½åŠ ãƒ»å‰Šé™¤æ™‚ã®çµæœã‚¯ãƒªã‚¢

```python
# ãƒ•ã‚£ãƒ«ã‚¿å‰Šé™¤æ™‚
if st.button("ğŸ—‘ï¸", key=f"remove_filter_{i}"):
    st.session_state.filters.pop(i)
    st.session_state.results = None  # çµæœã‚’ã‚¯ãƒªã‚¢
    st.rerun()

# ãƒ•ã‚£ãƒ«ã‚¿è¿½åŠ æ™‚
if st.button("â• Add Filter"):
    st.session_state.filters.append({'material': 'Al', 'thickness': 1.0})
    st.session_state.results = None  # çµæœã‚’ã‚¯ãƒªã‚¢
    st.rerun()
```

## ä¿®æ­£å¾Œã®å‹•ä½œ

### ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ 1: Alåšã•å¤‰æ›´
- Al 2.5mm â†’ 5.0mmå¤‰æ›´æ™‚
  - ESAK: 1.587 â†’ 1.005 mGyï¼ˆæ¸›å°‘ï¼‰
  - HVL1: 4.22 â†’ 5.88 mmï¼ˆå¢—åŠ ï¼‰
  - âœ… æœŸå¾…é€šã‚Šã®å‹•ä½œ

### ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ 2: Cu ãƒ•ã‚£ãƒ«ã‚¿è¿½åŠ 
- Al 5.0mm â†’ Al 5.0mm + Cu 0.5mmè¿½åŠ æ™‚
  - ESAK: 1.005 â†’ 0.346 mGyï¼ˆå¤§å¹…æ¸›å°‘ï¼‰
  - HVL1: 5.88 â†’ 10.05 mmï¼ˆå¤§å¹…å¢—åŠ ï¼‰
  - âœ… æœŸå¾…é€šã‚Šã®å‹•ä½œ

### ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ 3: ãƒ•ã‚£ãƒ«ã‚¿å‰Šé™¤
- Al 5.0mm + Cu 0.5mm â†’ Al 5.0mmã«æˆ»ã™æ™‚
  - ESAK: 0.346 â†’ 1.005 mGyï¼ˆå¢—åŠ ï¼‰
  - HVL1: 10.05 â†’ 5.88 mmï¼ˆæ¸›å°‘ï¼‰
  - âœ… æœŸå¾…é€šã‚Šã®å‹•ä½œ

## æ¤œè¨¼çµæœ

çµ±åˆãƒ†ã‚¹ãƒˆã«ã‚ˆã‚Šä»¥ä¸‹ãŒç¢ºèªã•ã‚Œã¾ã—ãŸï¼š

1. **ãƒ•ã‚£ãƒ«ã‚¿åŠ¹æœã®æ­£ç¢ºæ€§**: ãƒ•ã‚£ãƒ«ã‚¿åšã•ã®å¢—åŠ ã§ESAKæ¸›å°‘ã€HVLå¢—åŠ 
2. **çŠ¶æ…‹åˆ†é›¢**: è¨ˆç®—ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹é–“ã§ã®ãƒ•ã‚£ãƒ«ã‚¿çŠ¶æ…‹ã®ç‹¬ç«‹æ€§
3. **ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹**: ã‚¼ãƒ­åšã•ãƒ•ã‚£ãƒ«ã‚¿ã€è¤‡æ•°åŒæè³ªãƒ•ã‚£ãƒ«ã‚¿ã®æ­£å¸¸å‹•ä½œ
4. **åºƒç¯„å›²ãƒ†ã‚¹ãƒˆ**: ESAKç¯„å›² 0.346-2.521 mGyã€HVLç¯„å›² 2.62-10.05 mm

## åˆ©ç”¨æ™‚ã®æ³¨æ„ç‚¹

1. **å†è¨ˆç®—ã®å¿…è¦æ€§**: ãƒ•ã‚£ãƒ«ã‚¿è¨­å®šã‚’å¤‰æ›´ã—ãŸå ´åˆã¯ã€å¿…ãšã€ŒCalculate ESAKã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦å†è¨ˆç®—ã—ã¦ãã ã•ã„ã€‚

2. **çµæœã®è‡ªå‹•ã‚¯ãƒªã‚¢**: ãƒ•ã‚£ãƒ«ã‚¿ã‚’å¤‰æ›´ã™ã‚‹ã¨ã€ä»¥å‰ã®è¨ˆç®—çµæœã¯è‡ªå‹•çš„ã«ã‚¯ãƒªã‚¢ã•ã‚Œã¾ã™ã€‚

3. **åšã•è¨­å®š**: ãƒ•ã‚£ãƒ«ã‚¿åšã•ã‚’0.0mmã«è¨­å®šã—ãŸå ´åˆã€ãã®ãƒ•ã‚£ãƒ«ã‚¿ã¯è¨ˆç®—ã«å«ã¾ã‚Œã¾ã›ã‚“ã€‚

## æŠ€è¡“çš„è©³ç´°

### ãƒ•ã‚£ãƒ«ã‚¿é©ç”¨å‡¦ç†
```python
for filter_config in st.session_state.filters:
    if filter_config['thickness'] > 0:
        calculator.add_filtration(
            filter_config['material'], 
            filter_config['thickness']
        )
```

### SpekPyã§ã®ãƒ•ã‚£ãƒ«ã‚¿å‡¦ç†
```python
self.spectrum.filter(
    filter_config['material'],
    filter_config['thickness_mm']
)
```

ã“ã®ä¿®æ­£ã«ã‚ˆã‚Šã€ãƒ•ã‚£ãƒ«ã‚¿è¨­å®šã®å¤‰æ›´ãŒæ­£ç¢ºã«ã‚¹ãƒšã‚¯ãƒˆãƒ«ã¨ç·šé‡è¨ˆç®—ã«åæ˜ ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚